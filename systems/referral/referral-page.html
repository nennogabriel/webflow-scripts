<script>
document.addEventListener('DOMContentLoaded', function() {
    const yourReferrerId = localStorage.getItem('yourReferrerId');
    const yourReferrerSlug = localStorage.getItem('yourReferrerSlug');
    const email = localStorage.getItem('email');
    const mainReferrerLink = document.getElementById('main-referrer-link');

    function updateLink(referrerId) {
        const newUrl = `https://zigchain-landing-page.webflow.io/?z=${referrerId}`;
        if (mainReferrerLink) {
            mainReferrerLink.href = newUrl;
            mainReferrerLink.textContent = newUrl;
        }
    }

    function checkForReferrerId() {
        const yourReferrerId = localStorage.getItem('yourReferrerId');
        if (yourReferrerId) {
            updateLink(yourReferrerId);
            return true;
        }
        return false;
    }

    if (yourReferrerSlug) {
        updateLink(yourReferrerSlug);
    } else if (yourReferrerId) {
        updateLink(yourReferrerId);
    } else if (email) {
        let attempts = 0;
        const interval = setInterval(() => {
            attempts++;
            if (checkForReferrerId() || attempts >= 15) {
                clearInterval(interval);
                if (attempts >= 15) {
                    window.location.href = '/seekers';
                }
            }
        }, 200);
    } else {
        window.location.href = '/seekers';
    }
});
</script>