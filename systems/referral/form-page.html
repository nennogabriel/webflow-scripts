<script>
// Function to validate email
function isValidEmail(email) {
    const re = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    return re.test(email);
}

// Debounce function
function debounce(func, wait) {
    let timeout;
    return function(...args) {
        clearTimeout(timeout);
        timeout = setTimeout(() => func.apply(this, args), wait);
    };
}

// Function to save email in localStorage
function saveEmail(email) {
    if (isValidEmail(email)) {
        localStorage.setItem('email', email);
        localStorage.removeItem('youReferrerId');
    }
}

// Add input event listener to the email field
document.addEventListener('DOMContentLoaded', function() {
    const emailInput = document.querySelector('input[name="email"]');
    if (emailInput) {
        emailInput.addEventListener('input', debounce(function() {
            saveEmail(emailInput.value);
        }, 300));
    }
});

// Function to pre-fill the hidden input with referrer_id from localStorage
function populateReferrerId() {
    const referrerId = localStorage.getItem('referrer_id');
    if (referrerId) {
        const referrerInput = document.querySelector('input[name="referrer_id"]');
        if (referrerInput) {
            referrerInput.value = `"${referrerId}"`;
        }
    }
}

// Execute the function when the page loads, after a delay of 1 second
window.addEventListener('load', function() {
    setTimeout(populateReferrerId, 1000);
});
</script>